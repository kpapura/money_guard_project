import{R as n,_ as q,r as g,A,a as $,u as M,N as S,o as V,b as B,c as i,d as x,e as d,f as b,g as T,h as P,i as w,j as D,k as G,O as U,l as z,m as H,n as y,p as K,q as Q,F as Y,s as J,P as X,t as Z,v as ee,w as te,x as ne,y as se,z as ae,B as re,C as oe,D as ce,Q as le}from"./assets/vendor-76aba1d9.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();const ie="_form_jpfz7_1",ue={form:ie},k=({register:s,errors:e,name:t,placeholder:a})=>n.createElement("label",null,n.createElement("input",{autoComplete:t,...s(t),type:"text",placeholder:a}),(e==null?void 0:e[t])&&n.createElement("span",null,e[t].message)),de=({password:s})=>n.createElement(n.Fragment,null,n.createElement(q,{password:s,minLength:6,scoreWordStyle:{display:"none"}})),I=({register:s,errors:e,name:t,placeholder:a,getValues:r})=>{const[o,l]=g.useState("password"),[p,m]=g.useState("");function F(E){m(E.target.value)}return n.createElement("label",null,n.createElement("input",{autoComplete:t,...s(t,{required:"Password is required",validate:E=>{r("password")}}),type:o,placeholder:a,onChange:F})," ",n.createElement("div",{onClick:()=>{l(o==="password"?"text":"password")}},o==="password"?n.createElement(A,null):n.createElement($,null)),(e==null?void 0:e[t])&&n.createElement("span",null,e[t].message),t==="passwordConfirmation"&&n.createElement(de,{password:p}))},j=({onDataSubmit:s,formType:e,schema:t})=>{const{register:a,reset:r,handleSubmit:o,formState:{errors:l}}=M({resolver:V(t)}),p=m=>{delete m.passwordConfirmation,s(m),console.log(m),r()};return n.createElement("form",{className:ue.form,onSubmit:o(p)},e==="register"&&n.createElement(k,{register:a,errors:l,name:"username",placeholder:"Name"}),n.createElement(k,{register:a,errors:l,name:"email",placeholder:"Email"}),n.createElement(I,{register:a,errors:l,name:"password",placeholder:"Password"}),e==="register"&&n.createElement(n.Fragment,null,n.createElement(I,{register:a,errors:l,name:"passwordConfirmation",placeholder:"Confirm password"})),e==="login"?n.createElement(n.Fragment,null,n.createElement("button",{type:"submit"},"LOG IN"),n.createElement(S,{to:"/register"},"REGISTER")):n.createElement(n.Fragment,null,n.createElement("button",{type:"submit"},"REGISTER"),n.createElement(S,{to:"/login"},"LOGIN")),n.createElement("button",{hidden:!0}))},c=B.create({baseURL:"https://wallet.b.goit.study/api/"}),L=s=>{c.defaults.headers.common.Authorization=`Bearer ${s}`},me=()=>{c.defaults.headers.common.Authorization=""},h=i("register",async(s,e)=>{try{const{data:t}=await c.post("auth/sign-up",s);return L(t.token),t}catch(t){return e.rejectWithValue(t.message)}}),f=i("login",async(s,e)=>{try{const{data:t}=await c.post("auth/sign-in",s);return L(t.token),t}catch(t){return e.rejectWithValue(t.message)}});i("logout",async(s,e)=>{try{const{data:t}=await c.delete("auth/sign-out");return me(),t}catch(t){return e.rejectWithValue(t.message)}});const _=i("refresh",async(s,e)=>{const t=e.getState().auth.token;if(!t)return e.rejectWithValue("Token is not exist!");try{L(t);const{data:a}=await c.get("users/current");return a}catch(a){return e.rejectWithValue(a.message)}}),ge=x({password:d().required().min(6,"Must be more then 6 symbols").max(12,"Must be less then 12 symbols"),email:d().required().email("Email is not valid")}).required(),he=()=>{const s=b(),e=T(),t=r=>{e(f(r)).unwrap().then(()=>{s("/")}).catch(o=>{console.log(o.message)})},a={email:"tomato9@gmail.com",password:"0000000"};return n.createElement("div",null,n.createElement(j,{formType:"login",onDataSubmit:t,values:a,schema:ge}))},fe="_header_1snvw_1",pe="_hederContainer_1snvw_9",Ee="_logo_1snvw_17",we="_wrap_1snvw_27",ye="_user_1snvw_32",_e="_button_1snvw_38",ve="_icon_1snvw_52",Ce="_heder_1snvw_9",u={header:fe,hederContainer:pe,logo:Ee,wrap:we,user:ye,button:_e,icon:ve,heder:Ce},N={user:{username:"nata",email:"nata@hhh.com"},token:null,loading:!1,error:!1,isLoggedIn:!1,isRefresh:!1},R=P({name:"auth",initialState:N,selectors:{selectUser:s=>s.user,selectIsLoggedIn:s=>s.isLoggedIn,selectToken:s=>s.isLoggedIn,selectIsRefresh:s=>s.isRefresh},reducers:{logout:s=>N},extraReducers:s=>{s.addCase(_.fulfilled,(e,{payload:t})=>{e.user.username=t.username,e.user.email=t.email,e.isLoggedIn=!0,e.isRefresh=!1,e.loading=!1}).addMatcher(w(h.fulfilled,f.fulfilled),(e,{payload:t})=>{e.user.username=t.user.username,e.user.email=t.user.email,e.user.password=t.user.password,e.token=t.token,e.isLoggedIn=!0,e.loading=!1}).addMatcher(w(h.pending,f.pending,_.pending),e=>{e.loading=!0,e.error=null,e.isRefresh=!0}).addMatcher(w(h.rejected,f.rejected,_.rejected),(e,{payload:t})=>{e.error=t,e.loading=!1,e.isRefresh=!1})}}),be=R.reducer,{selectIsLoggedIn:Ye,selectUser:Te,selectToken:Je,selectIsRefresh:Xe}=R.selectors;R.actions;const Le=()=>{const[s,e]=g.useState(!1);return{isOpen:s,close:()=>e(!1),open:()=>e(!0),toggle:()=>e(o=>!o)}},Re="_modalWrapper_1t6co_1",Se="_modalContent_1t6co_11",ke="_closeButton_1t6co_23",v={modalWrapper:Re,modalContent:Se,closeButton:ke},Ie=document.querySelector("#modal"),Ne=({closeModal:s,children:e})=>{const t=g.useCallback(r=>{r.key==="Escape"&&s()},[s]);g.useEffect(()=>(document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}),[s,t]);const a=r=>{r.target===r.currentTarget&&s()};return D.createPortal(n.createElement("div",{onClick:a,className:v.modalWrapper},n.createElement("div",{className:v.modalContent},n.createElement("button",{className:v.closeButton,onClick:s},n.createElement("svg",{width:"16",height:"16"},n.createElement("use",{href:"../../img/sprite.svg#icon-close"}))),e)),Ie)},xe="_wrap_11xci_1",Pe="_logo_11xci_5",je="_text_11xci_14",C={wrap:xe,logo:Pe,text:je},Oe=({closeModal:s})=>{const e=b(),t=T(),a=()=>{t(a),e("/login")};return n.createElement("div",{className:C.wrap},n.createElement("a",{href:"",className:C.logo},n.createElement("svg",{width:"36",height:"36"},n.createElement("use",{href:"../../img/sprite.svg#icon-logo"})),"Money Guard"),n.createElement("p",{className:C.text},"Are you sure you want to log out?"),n.createElement("button",{onClick:a},"Logout"),n.createElement("button",{onClick:s},"Cancel"))},We=()=>{const{isOpen:s,toggle:e}=Le(),t=G(Te);return console.log(t),n.createElement("header",{className:u.header},n.createElement("div",{className:u.hederContainer},n.createElement("a",{href:"",className:u.logo},n.createElement("svg",{width:"24",height:"23"},n.createElement("use",{href:"../../img/sprite.svg#icon-logo"})),"Money Guard"),n.createElement("div",{className:u.wrap}," ",n.createElement("p",{className:u.user},t.email),n.createElement("button",{className:u.button,onClick:e},n.createElement("svg",{width:"18",height:"18",className:u.icon},n.createElement("use",{href:"../../img/sprite.svg#icon-exit"}))," ","Exit")),s&&n.createElement(Ne,{closeModal:e},n.createElement(Oe,{closeModal:e}))))},Fe=()=>n.createElement("div",null,n.createElement("h1",null,"helo"),n.createElement(We,null),n.createElement(U,null)),qe=x({username:d().required(),password:d().required().min(6,"Must be more then 6 symbols").max(12,"Must be less then 12 symbols"),email:d().required().email("Email is not valid"),passwordConfirmation:d().oneOf([z("password"),null],"Passwords must match")}).required(),Ae=()=>{const s=T(),e=b(),t=a=>{s(h(a)),e("/login")};return n.createElement("div",null,n.createElement(j,{onDataSubmit:t,formType:"register",schema:qe}))},$e=i("fetchTransactionsData",async(s,e)=>{try{const{data:t}=await c.get("transactions");return t}catch(t){return e.rejectWithValue(t.message)}}),Me=i("deleteTransaction",async(s,e)=>{try{return await c.delete(`transactions/${s}`),s}catch(t){return e.rejectWithValue(t.message)}}),Ve=i("addTransaction",async(s,e)=>{try{const{data:t}=await c.post("transactions",s);return t}catch(t){return e.rejectWithValue(t.message)}}),Be=i("editTransaction",async(s,e)=>{try{const{data:t}=await c.patch(`/transactions/${s.id}`,s);return t}catch(t){return e.rejectWithValue(t.message)}}),De=i("fetchTransactionCategories",async(s,e)=>{try{const{data:t}=await c.get("transaction-categories");return t}catch(t){return e.rejectWithValue(t.message)}});i("fetchTransactionSummaryController",async(s,e)=>{try{const{data:t}=await c.get("transactions-summary");return t}catch(t){return e.rejectWithValue(t.message)}});function Ge(){return n.createElement("div",null,n.createElement("h1",null,"Hello"),n.createElement(H,null,n.createElement(y,{path:"/",element:n.createElement(Fe,null)},n.createElement(y,{path:"login",element:n.createElement(he,null)}),n.createElement(y,{path:"register",element:n.createElement(Ae,null)}))))}const Ue={transactionsList:[],transactionCategories:[],transactionSummaryController:null,loading:!1,error:!1},O=P({name:"transactions",initialState:Ue,selectors:{selectTransactions:s=>s.transactionsList,selectIsLoading:s=>s.loading,selectIsError:s=>s.error,selectTransactionCategories:s=>s.transactionCategories},extraReducers:s=>{s.addCase($e.fulfilled,(e,{payload:t})=>{e.transactionsList=t,e.loading=!1}).addCase(Me.fulfilled,(e,{payload:t})=>{e.transactionsList=e.transactionsList.filter(a=>a.id!==t),e.loading=!1}).addCase(Ve.fulfilled,(e,{payload:t})=>{e.transactionsList.push(t),e.loading=!1}).addCase(Be.fulfilled,(e,{payload:t})=>{const a=e.transactionsList.findIndex(r=>r.id===t.id);e.transactionsList.splice(a,1,t),e.loading=!1}).addCase(De.fulfilled,(e,{payload:t})=>{e.transactionCategories=t,e.loading=!1})}}),ze=O.reducer;O.selectors;const He={key:"auth",version:1,storage:se,whitelist:["token"]},W=K({reducer:{auth:Q(He,be),transactions:ze},middleware:s=>s({serializableCheck:{ignoredActions:[Y,J,X,Z,ee,te]}}),devTools:!1}),Ke=ne(W);ae.createRoot(document.getElementById("root")).render(n.createElement(re,null,n.createElement(oe,{store:W},n.createElement(ce,{loading:null,persistor:Ke},n.createElement(Ge,null),n.createElement(le,{autoClose:1500})))));
//# sourceMappingURL=commonHelpers.js.map
