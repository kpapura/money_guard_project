import{R as i,a as I,c,b as R,i as l,p as S,d as w,e as P,f as V,F as W,g as A,P as C,h as O,j as b,k as v,l as M,m as x,n as U}from"./assets/vendor-0861a3e9.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();function _(){return i.createElement(i.Fragment,null,i.createElement("h1",null,"HELLO"))}const o=I.create({baseURL:"https://wallet.b.goit.study/api/"}),T=r=>{o.defaults.headers.common.Authorization=`Bearer ${r}`},F=()=>{o.defaults.headers.common.Authorization=""},u=c("register",async(r,t)=>{try{const{data:e}=await o.post("auth/sign-up",r);return T(e.token),console.log(e),e}catch(e){return t.rejectWithValue(e.message)}}),f=c("login",async(r,t)=>{try{const{data:e}=await o.post("auth/sign-in",r);return T(e.token),console.log(e),e}catch(e){return t.rejectWithValue(e.message)}}),$=c("logout",async(r,t)=>{try{const{data:e}=await o.delete("auth/sign-out");return console.log(e),F(),e}catch(e){return t.rejectWithValue(e.message)}}),g=c("refresh",async(r,t)=>{const e=t.getState().auth.token;if(!e)return t.rejectWithValue("Token is not exist!");try{T(e);const{data:a}=await o.get("users/current");return a}catch(a){return t.rejectWithValue(a.message)}}),L={user:{name:"",email:""},token:null,loading:!1,error:!1,isLoggedIn:!1,isRefresh:!1},j=R({name:"auth",initialState:L,selectors:{selectUser:r=>r.user,selectIsLoggedIn:r=>r.isLoggedIn,selectToken:r=>r.isLoggedIn,selectIsRefresh:r=>r.isRefresh},extraReducers:r=>{r.addCase($.fulfilled,t=>L).addCase(g.fulfilled,(t,{payload:e})=>{t.user.name=e.name,t.user.email=e.email,t.isLoggedIn=!0,t.isRefresh=!1}).addMatcher(l(u.fulfilled,f.fulfilled),(t,{payload:e})=>{t.user.name=e.user.name,t.user.email=e.user.email,t.token=e.token,t.isLoggedIn=!0}).addMatcher(l(u.pending,f.pending,g.pending),t=>{t.loading=!0,t.error=null,t.isRefresh=!0}).addMatcher(l(u.rejected,f.rejected,g.rejected),(t,{payload:e})=>{t.error=e,t.loading=!1,t.isRefresh=!1})}}),z=j.reducer;j.selectors;const h=c("fetchTransactionsData",async(r,t)=>{try{const{data:e}=await o.get("transactions");return console.log(e),e}catch(e){return t.rejectWithValue(e.message)}}),m=c("deleteTransaction",async(r,t)=>{try{const{data:e}=await o.delete(`transactions/${r}`);return console.log(e),e.id}catch(e){return t.rejectWithValue(e.message)}}),p=c("addTransaction",async(r,t)=>{try{const{data:e}=await o.post("transactions",r);return console.log(e),e}catch(e){return t.rejectWithValue(e.message)}}),y=c("editTransaction",async(r,t)=>{try{const{data:e}=await o.patch(`/transactions/${r.id}`,r);return console.log(e),e}catch(e){return t.rejectWithValue(e.message)}}),D={transactionsList:[],loading:!1,error:!1},k=R({name:"transactions",initialState:D,selectors:{selectTransactions:r=>r.transactionsList,selectIsLoading:r=>r.loading,selectIsError:r=>r.error},extraReducers:r=>{r.addCase(h.fulfilled,(t,{payload:e})=>{t.transactionsList=e,t.loading=!1}).addCase(m.fulfilled,(t,{payload:e})=>{t.transactionsList=t.transactionsList.filter(a=>a.id!==e),t.loading=!1}).addCase(p.fulfilled,(t,{payload:e})=>{t.transactionsList.push(e),t.loading=!1}).addCase(y.fulfilled,(t,{payload:e})=>{const a=t.transactionsList.findIndex(s=>s.id===e.id);t.transactionsList.splice(a,1,e),t.loading=!1}).addMatcher(l(h.pending,m.pending,p.pending,y.pending),(t,{payload:e})=>{t.loading=!0,t.error=null}).addMatcher(l(h.rejected,m.rejected,p.rejected,y.rejected),(t,{payload:e})=>{t.error=e,t.loading=!1})}}),G=k.reducer;k.selectors;const H={key:"auth",version:1,storage:V,whitelist:["token"]},N=S(H,z),E=w({reducer:{auth:N,transactions:G},middleware:r=>r({serializableCheck:{ignoredActions:[W,A,C,O,b,v]}}),devTools:!1}),B=P(E);M.createRoot(document.getElementById("root")).render(i.createElement(i.StrictMode,null,i.createElement(x,{store:E},i.createElement(U,{loading:null,persistor:B},i.createElement(_,null)))));
//# sourceMappingURL=commonHelpers.js.map
