import{a as ee,c as g,b as z,i as S,u as h,R as e,N as I,d as V,e as v,r as m,f as ue,g as T,O as H,_ as de,P as ge,h as _e,j as pe,o as he,k as te,l as b,B as ne,m as Ee,n as y,p as fe,q as E,s as we,t as Y,F as ye,v as be,w as ve,x as Ne,y as Se,z as Te,A as Ce,C as ae,D as Re,E as xe,G as ke,H as Ie,Q as Le}from"./assets/vendor-db165485.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const _ of c.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&s(_)}).observe(document,{childList:!0,subtree:!0});function n(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(r){if(r.ep)return;r.ep=!0;const c=n(r);fetch(r.href,c)}})();const u=ee.create({baseURL:"https://wallet.b.goit.study/api/"}),U=a=>{u.defaults.headers.common.Authorization=`Bearer ${a}`},We=()=>{u.defaults.headers.common.Authorization=""},C=g("register",async(a,t)=>{try{const{data:n}=await u.post("auth/sign-up",a);return U(n.token),n}catch(n){return t.rejectWithValue(n.response.data.message)}}),R=g("login",async(a,t)=>{try{const{data:n}=await u.post("auth/sign-in",a);return U(n.token),n}catch(n){return t.rejectWithValue(n.message)}}),se=g("logout",async(a,t)=>{try{const{data:n}=await u.delete("auth/sign-out");return We(),n}catch(n){return t.rejectWithValue(n.message)}}),B=g("refresh",async(a,t)=>{const n=t.getState().auth.token;if(!n)return t.rejectWithValue("Token is not exist!");try{U(n);const{data:s}=await u.get("users/current");return console.log(s),s}catch(s){return t.rejectWithValue(s.message)}}),P={user:{username:"",email:""},token:null,loading:!1,error:!1,isLoggedIn:!1,isRefresh:!1,balance:0},G=z({name:"auth",initialState:P,selectors:{selectUser:a=>a.user,selectIsLoggedIn:a=>a.isLoggedIn,selectToken:a=>a.isLoggedIn,selectIsRefresh:a=>a.isRefresh,selectBalance:a=>a.balance},reducers:{logout:a=>P},extraReducers:a=>{a.addCase(se.fulfilled,t=>P).addCase(B.fulfilled,(t,{payload:n})=>{t.user.username=n.username,t.user.email=n.email,t.balance=n.balance,t.isLoggedIn=!0,t.loading=!1,t.isRefresh=!1,t.loading=!1}).addMatcher(S(C.fulfilled,R.fulfilled),(t,{payload:n})=>{t.user.username=n.user.username,t.user.email=n.user.email,t.user.password=n.user.password,t.token=n.token,t.loading=!1,t.isLoggedIn=!0,t.loading=!1,t.isRefresh=!1}).addMatcher(S(C.pending,R.pending,B.pending),t=>{t.loading=!0,t.error=null,t.isRefresh=!0}).addMatcher(S(C.rejected,R.rejected,B.rejected),(t,{payload:n})=>{t.error=n,t.loading=!1,t.isRefresh=!1})}}),Be=G.reducer,{selectIsLoggedIn:L,selectUser:Pe,selectToken:gn,selectIsRefresh:Me,selectBalance:_n,selectIsLoading:pn}=G.selectors,{logout:De}=G.actions,M=({component:a,redirectTo:t="/"})=>h(L)?e.createElement(a,null):e.createElement(I,{to:t}),J=({component:a,redirectTo:t="/"})=>h(L)?e.createElement(I,{to:t}):e.createElement(a,null),Fe="_wrap_1nzyu_1",je="_logo_1nzyu_5",Oe="_text_1nzyu_14",D={wrap:Fe,logo:je,text:Oe},$e=({closeModal:a})=>{const t=V(),n=v(),s=()=>{n(se()),n(De()),a(),t("/")};return e.createElement("div",{className:D.wrap},e.createElement("a",{href:"",className:D.logo},e.createElement("svg",{width:"36",height:"36"},e.createElement("use",{href:"../../img/sprite.svg#icon-logo"})),"Money Guard"),e.createElement("p",{className:D.text},"Are you sure you want to log out?"),e.createElement("button",{className:"modalButtonColor",onClick:s},"Logout"),e.createElement("button",{className:"modalButton",onClick:a},"Cancel"))},Ae="_closeButton_11uif_2",qe="_modalContent_11uif_13",ze="_modalWrapper_11uif_33",F={closeButton:Ae,modalContent:qe,modalWrapper:ze},Ve=document.querySelector("#modal"),Ue=({closeModal:a,children:t})=>{const n=m.useCallback(r=>{r.key==="Escape"&&a()},[a]);m.useEffect(()=>(document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}),[a,n]);const s=r=>{r.target===r.currentTarget&&a()};return ue.createPortal(e.createElement("div",{onClick:s,className:F.modalWrapper},e.createElement("div",{className:F.modalContent},e.createElement("button",{className:F.closeButton,onClick:a},e.createElement("svg",{width:"16",height:"16"},e.createElement("use",{href:"../../img/sprite.svg#icon-close"}))),t)),Ve)},Ge=()=>{const[a,t]=m.useState(!1);return{isOpen:a,close:()=>t(!1),open:()=>t(!0),toggle:()=>t(c=>!c)}},Qe="_header_1snvw_1",He="_hederContainer_1snvw_9",Ye="_logo_1snvw_17",Je="_wrap_1snvw_27",Ke="_user_1snvw_32",Xe="_button_1snvw_38",Ze="_icon_1snvw_52",et="_heder_1snvw_9",f={header:Qe,hederContainer:He,logo:Ye,wrap:Je,user:Ke,button:Xe,icon:Ze,heder:et},tt=()=>{const{isOpen:a,toggle:t}=Ge(),n=h(Pe),s=n.email.indexOf("@"),r=n.email.slice(0,s);return e.createElement("header",{className:f.header},e.createElement("div",{className:f.hederContainer},e.createElement("a",{href:"",className:f.logo},e.createElement("svg",{width:"24",height:"23"},e.createElement("use",{href:"../../img/sprite.svg#icon-logo"})),"Money Guard"),e.createElement("div",{className:f.wrap}," ",e.createElement("p",{className:f.user},r),e.createElement("button",{className:f.button,onClick:t},e.createElement("svg",{width:"18",height:"18",className:f.icon},e.createElement("use",{href:"../../img/sprite.svg#icon-exit"}))," ","Exit")),a&&e.createElement(Ue,{closeModal:t},e.createElement($e,{closeModal:t}))))},re=()=>{const[a,t]=m.useState(window.innerWidth),n=()=>{t(window.innerWidth)};return m.useEffect(()=>(window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}),[]),{windowWidth:a}},nt=()=>{const a=re().windowWidth;return e.createElement("div",null,e.createElement(T,{to:"home"},"Home"),e.createElement(T,{to:"statistics"},"Statistics"),a<768&&e.createElement(T,{to:"/currency"},"Currency"))},at=()=>h(L)?e.createElement(e.Fragment,null,e.createElement(tt,null),e.createElement(nt,null),e.createElement(H,null)):e.createElement(e.Fragment,null,e.createElement(H,null)),st="_login_register_section_ytntg_1",rt="_register_login_section_ytntg_2",ct="_gradient_container_ytntg_24",ot="_form_container_ytntg_32",it="_form_ytntg_32",lt="_submit_btn_ytntg_70",mt="_inactive_btn_ytntg_90",ut="_password_label_ytntg_107",dt="_password_input_ytntg_116",gt="_error_container_ytntg_127",_t="_username_ytntg_131",pt="_email_ytntg_137",ht="_password_ytntg_107",Et="_cpassword_ytntg_149",ft="_eye_ytntg_164",wt="_name_label_ytntg_168",yt="_name_input_ytntg_176",bt="_name_user_icon_ytntg_195",vt="_icon_email_cont_ytntg_199",Nt="_password_icon_ytntg_203",St="_button_cont_ytntg_207",Tt="_strengthBar_ytntg_213",Ct="_porgress_container_ytntg_234",Rt="_logo_wrapper_ytntg_239",xt="_background_container_ytntg_289",o={login_register_section:st,register_login_section:rt,gradient_container:ct,form_container:ot,form:it,submit_btn:lt,inactive_btn:mt,password_label:ut,password_input:dt,error_container:gt,username:_t,email:pt,password:ht,cpassword:Et,eye:ft,name_label:wt,name_input:yt,name_user_icon:bt,icon_email_cont:vt,password_icon:Nt,button_cont:St,strengthBar:Tt,porgress_container:Ct,logo_wrapper:Rt,background_container:xt},K=({register:a,errors:t,name:n,placeholder:s,className:r})=>e.createElement(e.Fragment,null,e.createElement("div",{className:o.error_container},e.createElement("label",{className:o.name_label},n==="username"?e.createElement("div",{className:o.name_user_icon},e.createElement("svg",{width:"20",height:"24"},e.createElement("use",{href:"../../img/sprite.svg#icon-user"}))," "):e.createElement("div",{className:o.icon_email_cont},e.createElement("svg",{width:"20",height:"24"},e.createElement("use",{href:"../../img/sprite.svg#icon-email"}))),e.createElement("input",{className:o.name_input,autoComplete:"none",...a(n),type:"text",placeholder:s}))," ",(t==null?void 0:t[n])&&e.createElement("span",{className:o[r]},t[n].message))),kt=({password:a})=>e.createElement("div",{className:o.porgress_container},e.createElement(de,{password:a,minLength:6,scoreWordStyle:{display:"none"},className:o.strengthBar})),X=({register:a,errors:t,name:n,placeholder:s,getValues:r,formType:c,className:_})=>{const[w,l]=m.useState("password"),[d,p]=m.useState("");function W(N){p(N.target.value)}return e.createElement(e.Fragment,null,e.createElement("div",{className:o.error_container},e.createElement("label",{className:o.password_label},e.createElement("div",{className:o.password_icon},e.createElement("svg",{width:"20",height:"20"},e.createElement("use",{href:"../../img/sprite.svg#icon-lock"}))),e.createElement("input",{autoComplete:n,...a(n,{required:"Password is required",validate:N=>N===r("password")||"Passwords do not match"}),type:w,placeholder:s,onChange:W,className:o.password_input})," ",e.createElement("div",{className:o.eye,onClick:()=>{l(w==="password"?"text":"password")}},w==="password"?e.createElement(ge,{style:{color:"rgba(255, 255, 255, 0.4)"}}):e.createElement(_e,{style:{color:"rgba(255, 255, 255, 0.6)"}}))),(t==null?void 0:t[n])&&e.createElement("span",{className:o[_]},t[n].message)),n==="password"&&c!=="login"&&e.createElement(kt,{password:d}))},ce=({onDataSubmit:a,formType:t,schema:n})=>{const[s,r]=m.useState(0);m.useEffect(()=>{const p=()=>{r(window.innerWidth)};return window.addEventListener("resize",p),()=>{window.removeEventListener("resize",p)}},[]);const{register:c,reset:_,handleSubmit:w,formState:{errors:l}}=pe({resolver:he(n)}),d=p=>{const{passwordConfirmation:W,...N}=p;a(N),_()};return e.createElement("section",{className:t==="login"?`${o.login_register_section}`:`${o.register_login_section}`}," ",e.createElement("div",{className:o.background_container},e.createElement("div",{className:o.form_container,style:{padding:s<768&&t==="login"?"98px 20px":s>768&&t==="login"?"80px 62px":"40px 62px"}},e.createElement("a",{href:"",className:o.logo_wrapper,style:{paddingBottom:t==="login"?"11px":"0px"}},s<768?e.createElement("svg",{width:"25.5",height:"25.5"},e.createElement("use",{href:"../../img/sprite.svg#icon-logo"})):e.createElement("svg",{width:"36",height:"36"},e.createElement("use",{href:"../../img/sprite.svg#icon-logo"})),"Money Guard"),e.createElement("form",{className:o.form,onSubmit:w(d)},t==="register"&&e.createElement(K,{register:c,errors:l,name:"username",placeholder:"Name",className:"username"}),e.createElement(K,{register:c,errors:l,name:"email",placeholder:"E-mail",className:"email"}),e.createElement(X,{register:c,errors:l,name:"password",placeholder:"Password",onChange:p=>handleChange(p),formType:t,className:"password"}),t==="register"&&e.createElement(e.Fragment,null,e.createElement(X,{register:c,errors:l,name:"passwordConfirmation",placeholder:"Confirm password",className:"cpassword"})),t==="login"?e.createElement("div",{className:o.button_cont},e.createElement("button",{className:o.submit_btn,type:"submit"},"log in"),e.createElement(T,{className:o.inactive_btn,to:"/register"},"register")):e.createElement("div",{className:o.button_cont},e.createElement("button",{className:o.submit_btn,type:"submit"},"register"),e.createElement(T,{className:o.inactive_btn,to:"/login"},"log in"))," "))))},It=te({password:b().required().min(6,"Must be more then 6 symbols").max(12,"Must be less then 12 symbols"),email:b().required().email("Email is not valid")}).required(),Lt=()=>{const a=V(),t=v(),n=r=>{t(R(r)).unwrap().then(()=>{a("/home")}).catch(c=>{console.log(c.message),ne(c)})},s={email:"tomato9@gmail.com",password:"0000000"};return e.createElement("div",null,e.createElement(ce,{formType:"login",onDataSubmit:n,values:s,schema:It}))},Wt=te({username:b().required(),password:b().required().min(6,"Must be more then 6 symbols").max(12,"Must be less then 12 symbols"),email:b().required().email("Email is not valid"),passwordConfirmation:b().oneOf([Ee("password"),null],"Passwords must match")}).required(),Bt="_registerWrapper_15m0u_1",Pt={registerWrapper:Bt},Mt=()=>{const a=v(),t=V(),n=s=>{a(C(s)).unwrap().then(()=>{t("/home")}).catch(r=>{console.log(r),ne(r)})};return e.createElement("div",{className:Pt.registerWrapper},e.createElement(ce,{onDataSubmit:n,formType:"register",schema:Wt}))},x=g("fetchTransactionsData",async(a,t)=>{try{const{data:n}=await u.get("transactions");return n}catch(n){return t.rejectWithValue(n.message)}}),j=g("deleteTransaction",async(a,t)=>{try{return await u.delete(`transactions/${a}`),a}catch(n){return t.rejectWithValue(n.message)}}),O=g("addTransaction",async(a,t)=>{try{const{data:n}=await u.post("transactions",a);return n}catch(n){return t.rejectWithValue(n.message)}}),$=g("editTransaction",async(a,t)=>{try{const{data:n}=await u.patch(`/transactions/${a.id}`,a.content);return n}catch(n){return t.rejectWithValue(n.message)}}),k=g("fetchTransactionCategories",async(a,t)=>{try{const{data:n}=await u.get("transaction-categories");return n}catch(n){return t.rejectWithValue(n.message)}}),A=g("fetchTransactionSummaryController",async(a,t)=>{try{const{data:n}=await u.get(`transactions-summary?month=${a.month}&year=${a.year}`);return n}catch(n){return t.rejectWithValue(n.message)}}),Dt=()=>{const a=y.useMediaQuery({query:"(min-width: 768px)"}),t=y.useMediaQuery({query:"(min-width: 1280px)"}),n=y.useMediaQuery({query:"(max-width: 768px)"}),s=y.useMediaQuery({query:"(max-width: 767px)"}),r=y.useMediaQuery({query:"(orientation: portrait)"}),c=y.useMediaQuery({query:"(min-resolution: 2dppx)"});return{isBigScreenOrTablet:a,isBigScreen:t,isMobile:s,isTabletOrMobile:n,isPortrait:r,isRetina:c}},oe=g("currency/fetchCurrencyRate",async()=>{const a=localStorage.getItem("currencyRate"),t=localStorage.getItem("lastFetchTime");if(a&&t&&(new Date().getTime()-t)/(1e3*60*60)<1)return JSON.parse(a);try{const n=await ee.get("https://api.monobank.ua/bank/currency");return localStorage.setItem("currencyRate",JSON.stringify(n.data)),localStorage.setItem("lastFetchTime",new Date().getTime().toString()),n.data}catch(n){console.error("Помилка при виконанні запиту до Monobank:",n)}}),Ft={usdRate:null,eurRate:null,lastFetchTime:null},ie=z({name:"currency",initialState:Ft,selectors:{selectUsdRate:a=>a.usdRate,selectEurRate:a=>a.eurRate,selectLastFetchTime:a=>a.lastFetchTime},extraReducers:a=>{a.addCase(oe.fulfilled,(t,{payload:n})=>{t.usdRate=n.find(s=>s.currencyCodeA===840&&s.currencyCodeB===980),t.eurRate=n.find(s=>s.currencyCodeA===978&&s.currencyCodeB===980),t.lastFetchTime=new Date().getTime().toString()})}}),jt=ie.reducer,{selectUsdRate:Ot,selectEurRate:$t,selectLastFetchTime:At}=ie.selectors,qt="_wrapper_d2ubo_14",zt="_title_d2ubo_49",Vt="_row_d2ubo_79",Ut="_titleItem_d2ubo_97",Gt="_rowItem_d2ubo_98",Qt="_vector_d2ubo_104",Ht="_image_d2ubo_109",Yt="_secondimage_d2ubo_132",Jt="_smallnumeur_d2ubo_148",Kt="_smallnumusd_d2ubo_158",i={wrapper:qt,title:zt,row:Vt,titleItem:Ut,rowItem:Gt,vector:Qt,image:Ht,secondimage:Yt,smallnumeur:Jt,smallnumusd:Kt};function Xt(){const a=v(),t=h(Ot),n=h($t),s=h(At),{isDesktopOrLaptop:r,isBigScreen:c,isTabletOrMobile:_,isRetina:w}=Dt();let l="../../img/images/currency_mobile.webp",d="../../img/images/line_desc_mob_1x.webp";return window.devicePixelRatio>=2?r||c?(l="../../img/images/currency_desk@2x.webp",d="../../img/images/line_desc_2x.webp"):_&&(l="../../img/images/currency_tablet@2x.webp",d="../../img/images/line_desc_tab_2x.webp"):r||c?(l="../../img/images/currency_desk.webp",d="../../img/images/line_desc_1x.webp"):_&&(l="../../img/images/currency_tablet.webp",d="../../img/images/line_desc_tab_1x.webp"),m.useEffect(()=>{(new Date().getTime()-s)/(1e3*60*60)>1&&a(oe())},[a,s]),e.createElement("div",{className:i.wrapper},e.createElement("div",{className:i.secondwrapper},e.createElement("ul",{className:i.title},e.createElement("li",{className:i.titleItem},"Currency"),e.createElement("li",{className:i.titleItem},"Purchase"),e.createElement("li",{className:i.titleItem},"Sale")),t&&e.createElement("ul",{className:i.row},e.createElement("li",{className:i.rowItem},"USD"),e.createElement("li",{className:i.rowItem},t.rateBuy),e.createElement("li",{className:i.rowItem},t.rateSell)),n&&e.createElement("ul",{className:i.row},e.createElement("li",{className:i.rowItem},"EUR"),e.createElement("li",{className:i.rowItem},n.rateBuy),e.createElement("li",{className:i.rowItem},n.rateSell)),r&&e.createElement(e.Fragment,null,e.createElement("p",{className:i.smallnumeur}," ",n.rateBuy),e.createElement("p",{className:i.smallnumusd}," ",t.rateBuy)),e.createElement("img",{className:i.image,src:l,alt:"Currency rate"}),e.createElement("img",{className:i.secondimage,src:d,alt:"Currency rate"})))}const le=()=>e.createElement(Xt,null),Zt=()=>{const a=re().windowWidth,t=v();return m.useEffect(()=>{t(x())},[t]),m.useEffect(()=>{t(k())},[t]),e.createElement(e.Fragment,null,a>=768&&e.createElement(le,null),e.createElement(TransactionsList,null))},en="_loaderWrapper_1hccn_1",tn="_loader_1hccn_1",nn="_spinner_1hccn_1",an="_loaderName_1hccn_34",q={loaderWrapper:en,loader:tn,spinner:nn,loaderName:an},Z=()=>e.createElement("div",{className:q.loaderWrapper},e.createElement("div",{className:q.loader},e.createElement("span",{className:q.loaderName}))),sn=()=>e.createElement("h2",null,"Statistics");function rn(){const a=h(L),t=h(Me);return v(),t?e.createElement(Z,null):e.createElement(e.Fragment,null,e.createElement(m.Suspense,{fallback:e.createElement(Z,null)},e.createElement(fe,null,e.createElement(E,{path:"/",element:e.createElement(at,null)},e.createElement(E,{index:!0,element:e.createElement(J,{component:Lt,redirectTo:"/home"})}),e.createElement(E,{path:"register",element:e.createElement(J,{component:Mt,redirectTo:"/home"})}),e.createElement(E,{path:"/home",element:e.createElement(M,{component:Zt,redirectTo:"/"})}),e.createElement(E,{path:"/statistics",element:e.createElement(M,{component:sn,redirectTo:"/"})}),e.createElement(E,{path:"/currency",element:e.createElement(M,{component:le,redirectTo:"/"})})),e.createElement(E,{path:"*",element:a?e.createElement(I,{to:"/home"}):e.createElement(I,{to:"/"})}))))}const cn={transactionsList:[],transactionCategories:[],categoriesSummary:[],expenseSummary:0,incomeSummary:0,month:new Date().getMonth()+1,year:new Date().getFullYear(),periodTotal:0,loading:!1,error:!1},Q=z({name:"transactions",initialState:cn,selectors:{selectTransactions:a=>a.transactionsList,selectIsLoading:a=>a.loading,selectIsError:a=>a.error,selectTransactionCategories:a=>a.transactionCategories,selectMonth:a=>a.month,selectYear:a=>a.year,selectCategoriesSummary:a=>a.categoriesSummary,selectExpenseSummary:a=>a.expenseSummary,selectIncomeSummary:a=>a.incomeSummary,selectPeriodTotal:a=>a.periodTotal},reducers:{selectedYear:(a,{payload:t})=>{a.year=t},selectedMonth:(a,{payload:t})=>{a.month=t}},extraReducers:a=>{a.addCase(x.fulfilled,(t,{payload:n})=>{t.transactionsList=n,t.loading=!1}).addCase(j.fulfilled,(t,{payload:n})=>{t.transactionsList=t.transactionsList.filter(s=>s.id!==n),t.loading=!1}).addCase(O.fulfilled,(t,{payload:n})=>{t.transactionsList.push(n),t.loading=!1}).addCase($.fulfilled,(t,{payload:n})=>{const s=t.transactionsList.findIndex(r=>r.id===n.id);t.transactionsList.splice(s,1,n),t.loading=!1}).addCase(k.fulfilled,(t,{payload:n})=>{t.transactionCategories=n,t.loading=!1}).addCase(A.fulfilled,(t,{payload:n})=>{t.categoriesSummary=n.categoriesSummary,t.expenseSummary=n.expenseSummary,t.incomeSummary=n.incomeSummary,t.periodTotal=n.periodTotal,t.loading=!1}).addMatcher(S(x.pending,j.pending,O.pending,$.pending,k.pending,A.pending),(t,{payload:n})=>{t.loading=!0,t.error=null}).addMatcher(S(x.rejected,j.rejected,O.rejected,$.rejected,k.rejected,A.rejected),(t,{payload:n})=>{t.error=n,t.loading=!1})}}),on=Q.reducer;Q.actions;Q.selectors;const ln={key:"auth",version:1,storage:ae,whitelist:["token"]},mn={key:"root",storage:ae},me=we({reducer:{auth:Y(ln,Be),transactions:on,currency:Y(mn,jt)},middleware:a=>a({serializableCheck:{ignoredActions:[ye,be,ve,Ne,Se,Te]}}),devTools:!1}),un=Ce(me);Re.createRoot(document.getElementById("root")).render(e.createElement(xe,null,e.createElement(ke,{store:me},e.createElement(Ie,{loading:null,persistor:un},e.createElement(rn,null),e.createElement(Le,{autoClose:1500})))));
//# sourceMappingURL=commonHelpers.js.map
