import{R as n,_ as A,r as g,A as B,a as $,u as V,N as k,o as M,b as D,c as i,d as x,e as d,f as T,g as L,h as P,i as w,j as G,k as z,O as U,l as H,m as K,n as y,p as Q,q as Y,F as J,s as X,P as Z,t as ee,v as te,w as ne,x as se,y as ae,z as re,B as oe,C as ce,D as le,Q as ie}from"./assets/vendor-76aba1d9.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();const ue="_form_jpfz7_1",de={form:ue},I=({register:s,errors:e,name:t,placeholder:r})=>n.createElement("label",null,n.createElement("input",{autoComplete:t,...s(t),type:"text",placeholder:r}),(e==null?void 0:e[t])&&n.createElement("span",null,e[t].message)),me=({password:s})=>n.createElement(n.Fragment,null,n.createElement(A,{password:s,minLength:6,scoreWordStyle:{display:"none"}})),N=({register:s,errors:e,name:t,placeholder:r,getValues:a})=>{const[o,l]=g.useState("password"),[p,m]=g.useState("");function q(E){m(E.target.value)}return n.createElement("label",null,n.createElement("input",{autoComplete:t,...s(t,{required:"Password is required",validate:E=>{a("password")}}),type:o,placeholder:r,onChange:q})," ",n.createElement("div",{onClick:()=>{l(o==="password"?"text":"password")}},o==="password"?n.createElement(B,null):n.createElement($,null)),(e==null?void 0:e[t])&&n.createElement("span",null,e[t].message),t==="passwordConfirmation"&&n.createElement(me,{password:p}))},O=({onDataSubmit:s,formType:e,schema:t})=>{const{register:r,reset:a,handleSubmit:o,formState:{errors:l}}=V({resolver:M(t)}),p=m=>{delete m.passwordConfirmation,s(m),console.log(m),a()};return n.createElement("form",{className:de.form,onSubmit:o(p)},e==="register"&&n.createElement(I,{register:r,errors:l,name:"username",placeholder:"Name"}),n.createElement(I,{register:r,errors:l,name:"email",placeholder:"Email"}),n.createElement(N,{register:r,errors:l,name:"password",placeholder:"Password"}),e==="register"&&n.createElement(n.Fragment,null,n.createElement(N,{register:r,errors:l,name:"passwordConfirmation",placeholder:"Confirm password"})),e==="login"?n.createElement(n.Fragment,null,n.createElement("button",{type:"submit"},"LOG IN"),n.createElement(k,{to:"/register"},"REGISTER")):n.createElement(n.Fragment,null,n.createElement("button",{type:"submit"},"REGISTER"),n.createElement(k,{to:"/login"},"LOGIN")),n.createElement("button",{hidden:!0}))},c=D.create({baseURL:"https://wallet.b.goit.study/api/"}),R=s=>{c.defaults.headers.common.Authorization=`Bearer ${s}`},ge=()=>{c.defaults.headers.common.Authorization=""},h=i("register",async(s,e)=>{try{const{data:t}=await c.post("auth/sign-up",s);return R(t.token),t}catch(t){return e.rejectWithValue(t.message)}}),f=i("login",async(s,e)=>{try{const{data:t}=await c.post("auth/sign-in",s);return R(t.token),t}catch(t){return e.rejectWithValue(t.message)}}),j=i("logout",async(s,e)=>{try{const{data:t}=await c.delete("auth/sign-out");return ge(),t}catch(t){return e.rejectWithValue(t.message)}}),_=i("refresh",async(s,e)=>{const t=e.getState().auth.token;if(!t)return e.rejectWithValue("Token is not exist!");try{R(t);const{data:r}=await c.get("users/current");return r}catch(r){return e.rejectWithValue(r.message)}}),he=x({password:d().required().min(6,"Must be more then 6 symbols").max(12,"Must be less then 12 symbols"),email:d().required().email("Email is not valid")}).required(),fe=()=>{const s=T(),e=L(),t=a=>{e(f(a)).unwrap().then(()=>{s("/")}).catch(o=>{console.log(o.message)})},r={email:"tomato9@gmail.com",password:"0000000"};return n.createElement("div",null,n.createElement(O,{formType:"login",onDataSubmit:t,values:r,schema:he}))},pe="_wrap_1nzyu_1",Ee="_logo_1nzyu_5",we="_text_1nzyu_14",v={wrap:pe,logo:Ee,text:we},C={user:{username:"",email:""},token:null,loading:!1,error:!1,isLoggedIn:!1,isRefresh:!1},S=P({name:"auth",initialState:C,selectors:{selectUser:s=>s.user,selectIsLoggedIn:s=>s.isLoggedIn,selectToken:s=>s.isLoggedIn,selectIsRefresh:s=>s.isRefresh},reducers:{logout:s=>C},extraReducers:s=>{s.addCase(j.fulfilled,e=>C).addCase(_.fulfilled,(e,{payload:t})=>{e.user.username=t.username,e.user.email=t.email,e.isLoggedIn=!0,e.isRefresh=!1,e.loading=!1}).addMatcher(w(h.fulfilled,f.fulfilled),(e,{payload:t})=>{e.user.username=t.user.username,e.user.email=t.user.email,e.user.password=t.user.password,e.token=t.token,e.isLoggedIn=!0,e.loading=!1}).addMatcher(w(h.pending,f.pending,_.pending),e=>{e.loading=!0,e.error=null,e.isRefresh=!0}).addMatcher(w(h.rejected,f.rejected,_.rejected),(e,{payload:t})=>{e.error=t,e.loading=!1,e.isRefresh=!1})}}),ye=S.reducer,{selectIsLoggedIn:Xe,selectUser:_e,selectToken:Ze,selectIsRefresh:et}=S.selectors,{logout:ve}=S.actions,Ce=({closeModal:s})=>{const e=T(),t=L(),r=()=>{t(j()),t(ve()),s(),e("/login")};return n.createElement("div",{className:v.wrap},n.createElement("a",{href:"",className:v.logo},n.createElement("svg",{width:"36",height:"36"},n.createElement("use",{href:"../../img/sprite.svg#icon-logo"})),"Money Guard"),n.createElement("p",{className:v.text},"Are you sure you want to log out?"),n.createElement("button",{className:"modalButtonColor",onClick:r},"Logout"),n.createElement("button",{className:"modalButton",onClick:s},"Cancel"))},be="_modalWrapper_1t6co_1",Te="_modalContent_1t6co_11",Le="_closeButton_1t6co_23",b={modalWrapper:be,modalContent:Te,closeButton:Le},Re=document.querySelector("#modal"),Se=({closeModal:s,children:e})=>{const t=g.useCallback(a=>{a.key==="Escape"&&s()},[s]);g.useEffect(()=>(document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}),[s,t]);const r=a=>{a.target===a.currentTarget&&s()};return G.createPortal(n.createElement("div",{onClick:r,className:b.modalWrapper},n.createElement("div",{className:b.modalContent},n.createElement("button",{className:b.closeButton,onClick:s},n.createElement("svg",{width:"16",height:"16"},n.createElement("use",{href:"../../img/sprite.svg#icon-close"}))),e)),Re)},ke=()=>{const[s,e]=g.useState(!1);return{isOpen:s,close:()=>e(!1),open:()=>e(!0),toggle:()=>e(o=>!o)}},Ie="_header_1snvw_1",Ne="_hederContainer_1snvw_9",xe="_logo_1snvw_17",Pe="_wrap_1snvw_27",Oe="_user_1snvw_32",je="_button_1snvw_38",We="_icon_1snvw_52",Fe="_heder_1snvw_9",u={header:Ie,hederContainer:Ne,logo:xe,wrap:Pe,user:Oe,button:je,icon:We,heder:Fe},qe=()=>{const{isOpen:s,toggle:e}=ke(),t=z(_e),r=t.email.indexOf("@"),a=t.email.slice(0,r);return n.createElement("header",{className:u.header},n.createElement("div",{className:u.hederContainer},n.createElement("a",{href:"",className:u.logo},n.createElement("svg",{width:"24",height:"23"},n.createElement("use",{href:"../../img/sprite.svg#icon-logo"})),"Money Guard"),n.createElement("div",{className:u.wrap}," ",n.createElement("p",{className:u.user},a),n.createElement("button",{className:u.button,onClick:e},n.createElement("svg",{width:"18",height:"18",className:u.icon},n.createElement("use",{href:"../../img/sprite.svg#icon-exit"}))," ","Exit")),s&&n.createElement(Se,{closeModal:e},n.createElement(Ce,{closeModal:e}))))},Ae=()=>n.createElement(n.Fragment,null,n.createElement(qe,null),n.createElement(U,null)),Be=x({username:d().required(),password:d().required().min(6,"Must be more then 6 symbols").max(12,"Must be less then 12 symbols"),email:d().required().email("Email is not valid"),passwordConfirmation:d().oneOf([H("password"),null],"Passwords must match")}).required(),$e=()=>{const s=L(),e=T(),t=r=>{s(h(r)),e("/login")};return n.createElement("div",null,n.createElement(O,{onDataSubmit:t,formType:"register",schema:Be}))},Ve=i("fetchTransactionsData",async(s,e)=>{try{const{data:t}=await c.get("transactions");return t}catch(t){return e.rejectWithValue(t.message)}}),Me=i("deleteTransaction",async(s,e)=>{try{return await c.delete(`transactions/${s}`),s}catch(t){return e.rejectWithValue(t.message)}}),De=i("addTransaction",async(s,e)=>{try{const{data:t}=await c.post("transactions",s);return t}catch(t){return e.rejectWithValue(t.message)}}),Ge=i("editTransaction",async(s,e)=>{try{const{data:t}=await c.patch(`/transactions/${s.id}`,s.content);return t}catch(t){return e.rejectWithValue(t.message)}}),ze=i("fetchTransactionCategories",async(s,e)=>{try{const{data:t}=await c.get("transaction-categories");return t}catch(t){return e.rejectWithValue(t.message)}});i("fetchTransactionSummaryController",async(s,e)=>{try{const{data:t}=await c.get("transactions-summary");return t}catch(t){return e.rejectWithValue(t.message)}});function Ue(){return n.createElement("div",null,n.createElement("h1",null,"Hello"),n.createElement(K,null,n.createElement(y,{path:"/",element:n.createElement(Ae,null)},n.createElement(y,{path:"login",element:n.createElement(fe,null)}),n.createElement(y,{path:"register",element:n.createElement($e,null)}))))}const He={transactionsList:[],transactionCategories:[],transactionSummaryController:null,loading:!1,error:!1},W=P({name:"transactions",initialState:He,selectors:{selectTransactions:s=>s.transactionsList,selectIsLoading:s=>s.loading,selectIsError:s=>s.error,selectTransactionCategories:s=>s.transactionCategories},extraReducers:s=>{s.addCase(Ve.fulfilled,(e,{payload:t})=>{e.transactionsList=t,e.loading=!1}).addCase(Me.fulfilled,(e,{payload:t})=>{e.transactionsList=e.transactionsList.filter(r=>r.id!==t),e.loading=!1}).addCase(De.fulfilled,(e,{payload:t})=>{e.transactionsList.push(t),e.loading=!1}).addCase(Ge.fulfilled,(e,{payload:t})=>{const r=e.transactionsList.findIndex(a=>a.id===t.id);e.transactionsList.splice(r,1,t),e.loading=!1}).addCase(ze.fulfilled,(e,{payload:t})=>{e.transactionCategories=t,e.loading=!1})}}),Ke=W.reducer;W.selectors;const Qe={key:"auth",version:1,storage:ae,whitelist:["token"]},F=Q({reducer:{auth:Y(Qe,ye),transactions:Ke},middleware:s=>s({serializableCheck:{ignoredActions:[J,X,Z,ee,te,ne]}}),devTools:!1}),Ye=se(F);re.createRoot(document.getElementById("root")).render(n.createElement(oe,null,n.createElement(ce,{store:F},n.createElement(le,{loading:null,persistor:Ye},n.createElement(Ue,null),n.createElement(ie,{autoClose:1500})))));
//# sourceMappingURL=commonHelpers.js.map
