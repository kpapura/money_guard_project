import{a as te,c as _,b as V,i as T,u as E,R as e,N as L,d as U,e as N,r as u,f as de,g as C,O as Y,_ as ge,P as _e,h as pe,j as he,o as Ee,k as ne,l as v,B as ae,m as fe,n as b,p as we,q as f,s as ye,t as J,F as be,v as ve,w as Ne,x as Se,y as Te,z as Ce,A as Re,C as se,D as xe,E as ke,G as Ie,H as Le,Q as We}from"./assets/vendor-db165485.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))r(c);new MutationObserver(c=>{for(const o of c)if(o.type==="childList")for(const p of o.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&r(p)}).observe(document,{childList:!0,subtree:!0});function n(c){const o={};return c.integrity&&(o.integrity=c.integrity),c.referrerPolicy&&(o.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?o.credentials="include":c.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(c){if(c.ep)return;c.ep=!0;const o=n(c);fetch(c.href,o)}})();const d=te.create({baseURL:"https://wallet.b.goit.study/api/"}),G=a=>{d.defaults.headers.common.Authorization=`Bearer ${a}`},Be=()=>{d.defaults.headers.common.Authorization=""},R=_("register",async(a,t)=>{try{const{data:n}=await d.post("auth/sign-up",a);return G(n.token),n}catch(n){return t.rejectWithValue(n.response.data.message)}}),x=_("login",async(a,t)=>{try{const{data:n}=await d.post("auth/sign-in",a);return G(n.token),n}catch(n){return t.rejectWithValue(n.message)}}),re=_("logout",async(a,t)=>{try{const{data:n}=await d.delete("auth/sign-out");return Be(),n}catch(n){return t.rejectWithValue(n.message)}}),P=_("refresh",async(a,t)=>{const n=t.getState().auth.token;if(!n)return t.rejectWithValue("Token is not exist!");try{G(n);const{data:r}=await d.get("users/current");return console.log(r),r}catch(r){return t.rejectWithValue(r.message)}}),M={user:{username:"",email:""},token:null,loading:!1,error:!1,isLoggedIn:!1,isRefresh:!1,balance:0},Q=V({name:"auth",initialState:M,selectors:{selectUser:a=>a.user,selectIsLoggedIn:a=>a.isLoggedIn,selectToken:a=>a.isLoggedIn,selectIsRefresh:a=>a.isRefresh,selectBalance:a=>a.balance},reducers:{logout:a=>M},extraReducers:a=>{a.addCase(re.fulfilled,t=>M).addCase(P.fulfilled,(t,{payload:n})=>{t.user.username=n.username,t.user.email=n.email,t.balance=n.balance,t.isLoggedIn=!0,t.loading=!1,t.isRefresh=!1,t.loading=!1}).addMatcher(T(R.fulfilled,x.fulfilled),(t,{payload:n})=>{t.user.username=n.user.username,t.user.email=n.user.email,t.user.password=n.user.password,t.token=n.token,t.loading=!1,t.isLoggedIn=!0,t.loading=!1,t.isRefresh=!1}).addMatcher(T(R.pending,x.pending,P.pending),t=>{t.loading=!0,t.error=null,t.isRefresh=!0}).addMatcher(T(R.rejected,x.rejected,P.rejected),(t,{payload:n})=>{t.error=n,t.loading=!1,t.isRefresh=!1})}}),Pe=Q.reducer,{selectIsLoggedIn:W,selectUser:Me,selectToken:dn,selectIsRefresh:De,selectBalance:gn,selectIsLoading:_n}=Q.selectors,{logout:Fe}=Q.actions,D=({component:a,redirectTo:t="/"})=>E(W)?e.createElement(a,null):e.createElement(L,{to:t}),K=({component:a,redirectTo:t="/"})=>E(W)?e.createElement(L,{to:t}):e.createElement(a,null),je="_wrap_1nzyu_1",Oe="_logo_1nzyu_5",$e="_text_1nzyu_14",F={wrap:je,logo:Oe,text:$e},Ae=({closeModal:a})=>{const t=U(),n=N(),r=()=>{n(re()),n(Fe()),a(),t("/")};return e.createElement("div",{className:F.wrap},e.createElement("a",{href:"",className:F.logo},e.createElement("svg",{width:"36",height:"36"},e.createElement("use",{href:"../../img/sprite.svg#icon-logo"})),"Money Guard"),e.createElement("p",{className:F.text},"Are you sure you want to log out?"),e.createElement("button",{className:"modalButtonColor",onClick:r},"Logout"),e.createElement("button",{className:"modalButton",onClick:a},"Cancel"))},qe="_closeButton_11uif_2",ze="_modalContent_11uif_13",Ve="_modalWrapper_11uif_33",j={closeButton:qe,modalContent:ze,modalWrapper:Ve},Ue=document.querySelector("#modal"),Ge=({closeModal:a,children:t})=>{const n=u.useCallback(c=>{c.key==="Escape"&&a()},[a]);u.useEffect(()=>(document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}),[a,n]);const r=c=>{c.target===c.currentTarget&&a()};return de.createPortal(e.createElement("div",{onClick:r,className:j.modalWrapper},e.createElement("div",{className:j.modalContent},e.createElement("button",{className:j.closeButton,onClick:a},e.createElement("svg",{width:"16",height:"16"},e.createElement("use",{href:"../../img/sprite.svg#icon-close"}))),t)),Ue)},Qe=()=>{const[a,t]=u.useState(!1);return{isOpen:a,close:()=>t(!1),open:()=>t(!0),toggle:()=>t(o=>!o)}},He="_header_1snvw_1",Ye="_hederContainer_1snvw_9",Je="_logo_1snvw_17",Ke="_wrap_1snvw_27",Xe="_user_1snvw_32",Ze="_button_1snvw_38",et="_icon_1snvw_52",tt="_heder_1snvw_9",w={header:He,hederContainer:Ye,logo:Je,wrap:Ke,user:Xe,button:Ze,icon:et,heder:tt},nt=()=>{const{isOpen:a,toggle:t}=Qe(),n=E(Me),r=n.email.indexOf("@"),c=n.email.slice(0,r);return e.createElement("header",{className:w.header},e.createElement("div",{className:w.hederContainer},e.createElement("a",{href:"",className:w.logo},e.createElement("svg",{width:"24",height:"23"},e.createElement("use",{href:"../../img/sprite.svg#icon-logo"})),"Money Guard"),e.createElement("div",{className:w.wrap}," ",e.createElement("p",{className:w.user},c),e.createElement("button",{className:w.button,onClick:t},e.createElement("svg",{width:"18",height:"18",className:w.icon},e.createElement("use",{href:"../../img/sprite.svg#icon-exit"}))," ","Exit")),a&&e.createElement(Ge,{closeModal:t},e.createElement(Ae,{closeModal:t}))))},ce=()=>{const[a,t]=u.useState(window.innerWidth),n=()=>{t(window.innerWidth)};return u.useEffect(()=>(window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}),[]),{windowWidth:a}},at=()=>{const a=ce().windowWidth;return e.createElement("div",null,e.createElement(C,{to:"home"},"Home"),e.createElement(C,{to:"statistics"},"Statistics"),a<768&&e.createElement(C,{to:"/currency"},"Currency"))},st=()=>E(W)?e.createElement(e.Fragment,null,e.createElement(nt,null),e.createElement(at,null),e.createElement(Y,null)):e.createElement(e.Fragment,null,e.createElement(Y,null)),rt="_login_register_section_ytntg_1",ct="_register_login_section_ytntg_2",ot="_gradient_container_ytntg_24",it="_form_container_ytntg_32",lt="_form_ytntg_32",mt="_submit_btn_ytntg_70",ut="_inactive_btn_ytntg_90",dt="_password_label_ytntg_107",gt="_password_input_ytntg_116",_t="_error_container_ytntg_127",pt="_username_ytntg_131",ht="_email_ytntg_137",Et="_password_ytntg_107",ft="_cpassword_ytntg_149",wt="_eye_ytntg_164",yt="_name_label_ytntg_168",bt="_name_input_ytntg_176",vt="_name_user_icon_ytntg_195",Nt="_icon_email_cont_ytntg_199",St="_password_icon_ytntg_203",Tt="_button_cont_ytntg_207",Ct="_strengthBar_ytntg_213",Rt="_porgress_container_ytntg_234",xt="_logo_wrapper_ytntg_239",kt="_background_container_ytntg_289",i={login_register_section:rt,register_login_section:ct,gradient_container:ot,form_container:it,form:lt,submit_btn:mt,inactive_btn:ut,password_label:dt,password_input:gt,error_container:_t,username:pt,email:ht,password:Et,cpassword:ft,eye:wt,name_label:yt,name_input:bt,name_user_icon:vt,icon_email_cont:Nt,password_icon:St,button_cont:Tt,strengthBar:Ct,porgress_container:Rt,logo_wrapper:xt,background_container:kt},X=({register:a,errors:t,name:n,placeholder:r,className:c})=>e.createElement(e.Fragment,null,e.createElement("div",{className:i.error_container},e.createElement("label",{className:i.name_label},n==="username"?e.createElement("div",{className:i.name_user_icon},e.createElement("svg",{width:"20",height:"24"},e.createElement("use",{href:"../../img/sprite.svg#icon-user"}))," "):e.createElement("div",{className:i.icon_email_cont},e.createElement("svg",{width:"20",height:"24"},e.createElement("use",{href:"../../img/sprite.svg#icon-email"}))),e.createElement("input",{className:i.name_input,autoComplete:"none",...a(n),type:"text",placeholder:r}))," ",(t==null?void 0:t[n])&&e.createElement("span",{className:i[c]},t[n].message))),It=({password:a})=>e.createElement("div",{className:i.porgress_container},e.createElement(ge,{password:a,minLength:6,scoreWordStyle:{display:"none"},className:i.strengthBar})),Z=({register:a,errors:t,name:n,placeholder:r,getValues:c,formType:o,className:p})=>{const[y,m]=u.useState("password"),[g,h]=u.useState("");function B(S){h(S.target.value)}return e.createElement(e.Fragment,null,e.createElement("div",{className:i.error_container},e.createElement("label",{className:i.password_label},e.createElement("div",{className:i.password_icon},e.createElement("svg",{width:"20",height:"20"},e.createElement("use",{href:"../../img/sprite.svg#icon-lock"}))),e.createElement("input",{autoComplete:n,...a(n,{required:"Password is required",validate:S=>S===c("password")||"Passwords do not match"}),type:y,placeholder:r,onChange:B,className:i.password_input})," ",e.createElement("div",{className:i.eye,onClick:()=>{m(y==="password"?"text":"password")}},y==="password"?e.createElement(_e,{style:{color:"rgba(255, 255, 255, 0.4)"}}):e.createElement(pe,{style:{color:"rgba(255, 255, 255, 0.6)"}}))),(t==null?void 0:t[n])&&e.createElement("span",{className:i[p]},t[n].message)),n==="password"&&o!=="login"&&e.createElement(It,{password:g}))},oe=({onDataSubmit:a,formType:t,schema:n})=>{const[r,c]=u.useState(0);u.useEffect(()=>{const h=()=>{c(window.innerWidth)};return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[]);const{register:o,reset:p,handleSubmit:y,formState:{errors:m}}=he({resolver:Ee(n)}),g=h=>{const{passwordConfirmation:B,...S}=h;a(S),p()};return e.createElement("section",{className:t==="login"?`${i.login_register_section}`:`${i.register_login_section}`}," ",e.createElement("div",{className:i.background_container},e.createElement("div",{className:i.form_container,style:{padding:r<768&&t==="login"?"98px 20px":r>768&&t==="login"?"80px 62px":"40px 62px"}},e.createElement("a",{href:"",className:i.logo_wrapper,style:{paddingBottom:t==="login"?"11px":"0px"}},r<768?e.createElement("svg",{width:"25.5",height:"25.5"},e.createElement("use",{href:"../../img/sprite.svg#icon-logo"})):e.createElement("svg",{width:"36",height:"36"},e.createElement("use",{href:"../../img/sprite.svg#icon-logo"})),"Money Guard"),e.createElement("form",{className:i.form,onSubmit:y(g)},t==="register"&&e.createElement(X,{register:o,errors:m,name:"username",placeholder:"Name",className:"username"}),e.createElement(X,{register:o,errors:m,name:"email",placeholder:"E-mail",className:"email"}),e.createElement(Z,{register:o,errors:m,name:"password",placeholder:"Password",onChange:h=>handleChange(h),formType:t,className:"password"}),t==="register"&&e.createElement(e.Fragment,null,e.createElement(Z,{register:o,errors:m,name:"passwordConfirmation",placeholder:"Confirm password",className:"cpassword"})),t==="login"?e.createElement("div",{className:i.button_cont},e.createElement("button",{className:i.submit_btn,type:"submit"},"log in"),e.createElement(C,{className:i.inactive_btn,to:"/register"},"register")):e.createElement("div",{className:i.button_cont},e.createElement("button",{className:i.submit_btn,type:"submit"},"register"),e.createElement(C,{className:i.inactive_btn,to:"/login"},"log in"))," "))))},Lt=ne({password:v().required().min(6,"Must be more then 6 symbols").max(12,"Must be less then 12 symbols"),email:v().required().email("Email is not valid")}).required(),Wt=()=>{const a=U(),t=N(),n=c=>{t(x(c)).unwrap().then(()=>{a("/home")}).catch(o=>{console.log(o.message),ae(o)})},r={email:"tomato9@gmail.com",password:"0000000"};return e.createElement("div",null,e.createElement(oe,{formType:"login",onDataSubmit:n,values:r,schema:Lt}))},Bt=ne({username:v().required(),password:v().required().min(6,"Must be more then 6 symbols").max(12,"Must be less then 12 symbols"),email:v().required().email("Email is not valid"),passwordConfirmation:v().oneOf([fe("password"),null],"Passwords must match")}).required(),Pt=()=>{const a=N(),t=U(),n=r=>{a(R(r)).unwrap().then(()=>{t("/home")}).catch(c=>{console.log(c),ae(c)})};return e.createElement("div",{className:s.registerWrapper},e.createElement(oe,{onDataSubmit:n,formType:"register",schema:Bt}))},k=_("fetchTransactionsData",async(a,t)=>{try{const{data:n}=await d.get("transactions");return n}catch(n){return t.rejectWithValue(n.message)}}),O=_("deleteTransaction",async(a,t)=>{try{return await d.delete(`transactions/${a}`),a}catch(n){return t.rejectWithValue(n.message)}}),$=_("addTransaction",async(a,t)=>{try{const{data:n}=await d.post("transactions",a);return n}catch(n){return t.rejectWithValue(n.message)}}),A=_("editTransaction",async(a,t)=>{try{const{data:n}=await d.patch(`/transactions/${a.id}`,a.content);return n}catch(n){return t.rejectWithValue(n.message)}}),I=_("fetchTransactionCategories",async(a,t)=>{try{const{data:n}=await d.get("transaction-categories");return n}catch(n){return t.rejectWithValue(n.message)}}),q=_("fetchTransactionSummaryController",async(a,t)=>{try{const{data:n}=await d.get(`transactions-summary?month=${a.month}&year=${a.year}`);return n}catch(n){return t.rejectWithValue(n.message)}}),Mt=()=>{const a=b.useMediaQuery({query:"(min-width: 768px)"}),t=b.useMediaQuery({query:"(min-width: 1280px)"}),n=b.useMediaQuery({query:"(max-width: 768px)"}),r=b.useMediaQuery({query:"(max-width: 767px)"}),c=b.useMediaQuery({query:"(orientation: portrait)"}),o=b.useMediaQuery({query:"(min-resolution: 2dppx)"});return{isBigScreenOrTablet:a,isBigScreen:t,isMobile:r,isTabletOrMobile:n,isPortrait:c,isRetina:o}},ie=_("currency/fetchCurrencyRate",async()=>{const a=localStorage.getItem("currencyRate"),t=localStorage.getItem("lastFetchTime");if(a&&t&&(new Date().getTime()-t)/(1e3*60*60)<1)return JSON.parse(a);try{const n=await te.get("https://api.monobank.ua/bank/currency");return localStorage.setItem("currencyRate",JSON.stringify(n.data)),localStorage.setItem("lastFetchTime",new Date().getTime().toString()),n.data}catch(n){console.error("Помилка при виконанні запиту до Monobank:",n)}}),Dt={usdRate:null,eurRate:null,lastFetchTime:null},le=V({name:"currency",initialState:Dt,selectors:{selectUsdRate:a=>a.usdRate,selectEurRate:a=>a.eurRate,selectLastFetchTime:a=>a.lastFetchTime},extraReducers:a=>{a.addCase(ie.fulfilled,(t,{payload:n})=>{t.usdRate=n.find(r=>r.currencyCodeA===840&&r.currencyCodeB===980),t.eurRate=n.find(r=>r.currencyCodeA===978&&r.currencyCodeB===980),t.lastFetchTime=new Date().getTime().toString()})}}),Ft=le.reducer,{selectUsdRate:jt,selectEurRate:Ot,selectLastFetchTime:$t}=le.selectors,At="_wrapper_d2ubo_14",qt="_title_d2ubo_49",zt="_row_d2ubo_79",Vt="_titleItem_d2ubo_97",Ut="_rowItem_d2ubo_98",Gt="_vector_d2ubo_104",Qt="_image_d2ubo_109",Ht="_secondimage_d2ubo_132",Yt="_smallnumeur_d2ubo_148",Jt="_smallnumusd_d2ubo_158",l={wrapper:At,title:qt,row:zt,titleItem:Vt,rowItem:Ut,vector:Gt,image:Qt,secondimage:Ht,smallnumeur:Yt,smallnumusd:Jt};function Kt(){const a=N(),t=E(jt),n=E(Ot),r=E($t),{isDesktopOrLaptop:c,isBigScreen:o,isTabletOrMobile:p,isRetina:y}=Mt();let m="../../img/images/currency_mobile.webp",g="../../img/images/line_desc_mob_1x.webp";return window.devicePixelRatio>=2?c||o?(m="../../img/images/currency_desk@2x.webp",g="../../img/images/line_desc_2x.webp"):p&&(m="../../img/images/currency_tablet@2x.webp",g="../../img/images/line_desc_tab_2x.webp"):c||o?(m="../../img/images/currency_desk.webp",g="../../img/images/line_desc_1x.webp"):p&&(m="../../img/images/currency_tablet.webp",g="../../img/images/line_desc_tab_1x.webp"),u.useEffect(()=>{(new Date().getTime()-r)/(1e3*60*60)>1&&a(ie())},[a,r]),e.createElement("div",{className:l.wrapper},e.createElement("div",{className:l.secondwrapper},e.createElement("ul",{className:l.title},e.createElement("li",{className:l.titleItem},"Currency"),e.createElement("li",{className:l.titleItem},"Purchase"),e.createElement("li",{className:l.titleItem},"Sale")),t&&e.createElement("ul",{className:l.row},e.createElement("li",{className:l.rowItem},"USD"),e.createElement("li",{className:l.rowItem},t.rateBuy),e.createElement("li",{className:l.rowItem},t.rateSell)),n&&e.createElement("ul",{className:l.row},e.createElement("li",{className:l.rowItem},"EUR"),e.createElement("li",{className:l.rowItem},n.rateBuy),e.createElement("li",{className:l.rowItem},n.rateSell)),c&&e.createElement(e.Fragment,null,e.createElement("p",{className:l.smallnumeur}," ",n.rateBuy),e.createElement("p",{className:l.smallnumusd}," ",t.rateBuy)),e.createElement("img",{className:l.image,src:m,alt:"Currency rate"}),e.createElement("img",{className:l.secondimage,src:g,alt:"Currency rate"})))}const me=()=>e.createElement(Kt,null),Xt=()=>{const a=ce().windowWidth,t=N();return u.useEffect(()=>{t(k())},[t]),u.useEffect(()=>{t(I())},[t]),e.createElement(e.Fragment,null,a>=768&&e.createElement(me,null),e.createElement(TransactionsList,null))},Zt="_loaderWrapper_1hccn_1",en="_loader_1hccn_1",tn="_spinner_1hccn_1",nn="_loaderName_1hccn_34",z={loaderWrapper:Zt,loader:en,spinner:tn,loaderName:nn},ee=()=>e.createElement("div",{className:z.loaderWrapper},e.createElement("div",{className:z.loader},e.createElement("span",{className:z.loaderName}))),an=()=>e.createElement("h2",null,"Statistics");function sn(){const a=E(W),t=E(De);return N(),t?e.createElement(ee,null):e.createElement(e.Fragment,null,e.createElement(u.Suspense,{fallback:e.createElement(ee,null)},e.createElement(we,null,e.createElement(f,{path:"/",element:e.createElement(st,null)},e.createElement(f,{index:!0,element:e.createElement(K,{component:Wt,redirectTo:"/home"})}),e.createElement(f,{path:"register",element:e.createElement(K,{component:Pt,redirectTo:"/home"})}),e.createElement(f,{path:"/home",element:e.createElement(D,{component:Xt,redirectTo:"/"})}),e.createElement(f,{path:"/statistics",element:e.createElement(D,{component:an,redirectTo:"/"})}),e.createElement(f,{path:"/currency",element:e.createElement(D,{component:me,redirectTo:"/"})})),e.createElement(f,{path:"*",element:a?e.createElement(L,{to:"/home"}):e.createElement(L,{to:"/"})}))))}const rn={transactionsList:[],transactionCategories:[],categoriesSummary:[],expenseSummary:0,incomeSummary:0,month:new Date().getMonth()+1,year:new Date().getFullYear(),periodTotal:0,loading:!1,error:!1},H=V({name:"transactions",initialState:rn,selectors:{selectTransactions:a=>a.transactionsList,selectIsLoading:a=>a.loading,selectIsError:a=>a.error,selectTransactionCategories:a=>a.transactionCategories,selectMonth:a=>a.month,selectYear:a=>a.year,selectCategoriesSummary:a=>a.categoriesSummary,selectExpenseSummary:a=>a.expenseSummary,selectIncomeSummary:a=>a.incomeSummary,selectPeriodTotal:a=>a.periodTotal},reducers:{selectedYear:(a,{payload:t})=>{a.year=t},selectedMonth:(a,{payload:t})=>{a.month=t}},extraReducers:a=>{a.addCase(k.fulfilled,(t,{payload:n})=>{t.transactionsList=n,t.loading=!1}).addCase(O.fulfilled,(t,{payload:n})=>{t.transactionsList=t.transactionsList.filter(r=>r.id!==n),t.loading=!1}).addCase($.fulfilled,(t,{payload:n})=>{t.transactionsList.push(n),t.loading=!1}).addCase(A.fulfilled,(t,{payload:n})=>{const r=t.transactionsList.findIndex(c=>c.id===n.id);t.transactionsList.splice(r,1,n),t.loading=!1}).addCase(I.fulfilled,(t,{payload:n})=>{t.transactionCategories=n,t.loading=!1}).addCase(q.fulfilled,(t,{payload:n})=>{t.categoriesSummary=n.categoriesSummary,t.expenseSummary=n.expenseSummary,t.incomeSummary=n.incomeSummary,t.periodTotal=n.periodTotal,t.loading=!1}).addMatcher(T(k.pending,O.pending,$.pending,A.pending,I.pending,q.pending),(t,{payload:n})=>{t.loading=!0,t.error=null}).addMatcher(T(k.rejected,O.rejected,$.rejected,A.rejected,I.rejected,q.rejected),(t,{payload:n})=>{t.error=n,t.loading=!1})}}),cn=H.reducer;H.actions;H.selectors;const on={key:"auth",version:1,storage:se,whitelist:["token"]},ln={key:"root",storage:se},ue=ye({reducer:{auth:J(on,Pe),transactions:cn,currency:J(ln,Ft)},middleware:a=>a({serializableCheck:{ignoredActions:[be,ve,Ne,Se,Te,Ce]}}),devTools:!1}),mn=Re(ue);xe.createRoot(document.getElementById("root")).render(e.createElement(ke,null,e.createElement(Ie,{store:ue},e.createElement(Le,{loading:null,persistor:mn},e.createElement(sn,null),e.createElement(We,{autoClose:1500})))));
//# sourceMappingURL=commonHelpers.js.map
